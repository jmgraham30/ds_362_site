<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JMG">

<title>DS 362 - Lesson 11</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet">


<link rel="stylesheet" href="../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">DS 362</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../links.html" rel="" target="">
 <span class="menu-text">Links</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jmgraham30/ds_362_site" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ethical-considerations-in-machine-learning" id="toc-ethical-considerations-in-machine-learning" class="nav-link active" data-scroll-target="#ethical-considerations-in-machine-learning">Ethical Considerations in Machine Learning</a></li>
  <li><a href="#case-studies" id="toc-case-studies" class="nav-link" data-scroll-target="#case-studies">Case Studies</a></li>
  <li><a href="#approaches-to-ethical-machine-learning" id="toc-approaches-to-ethical-machine-learning" class="nav-link" data-scroll-target="#approaches-to-ethical-machine-learning">Approaches to Ethical Machine Learning</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 11</h1>
<p class="subtitle lead">Ethical Considerations in Machine Learning</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>JMG </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p><a href="https://youtu.be/gV0_raKR2UQ?si=oCyVg8a7bmlLiN8-">Watch <em>Algorithmic Bias and Fairness</em> video on YouTube</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div class="vembedr" align="center">
<div>
<iframe src="https://www.youtube.com/embed/gV0_raKR2UQ?si=oCyVg8a7bmlLiN8-" width="800" height="450" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
</div>
<section id="ethical-considerations-in-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="ethical-considerations-in-machine-learning">Ethical Considerations in Machine Learning</h2>
<ol type="1">
<li><strong>Bias in Algorithmic Decision-Making:</strong>
<ul>
<li><strong>Prompt:</strong> Investigate instances where machine learning algorithms have exhibited bias in decision-making processes, leading to unfair outcomes for certain groups. Consider how biases might be introduced during data collection, model training, or in the design of the algorithms. Discuss the ethical implications of biased algorithms and potential strategies to mitigate bias in machine learning systems.</li>
<li><strong>Resource:</strong> <a href="https://ainowinstitute.org/aiareport2019.pdf">AI Now Institute - Algorithmic Accountability: A Primer</a></li>
</ul></li>
<li><strong>Ethical Considerations in Automated Hiring Systems:</strong>
<ul>
<li><strong>Prompt:</strong> Explore the ethical challenges associated with the use of machine learning in automated hiring systems. Consider issues such as fairness, transparency, and potential biases in the recruitment process. Discuss how the use of AI in hiring might impact diversity and inclusion and explore guidelines or best practices for ethical use in employment-related decision-making.</li>
<li><strong>Resource:</strong> <a href="https://datasociety.net/pubs/ia/DataAndSociety_Algorithmic_Accountability_Primer_2016.pdf">Algorithmic Accountability: A Primer for Employment</a></li>
</ul></li>
<li><strong>Privacy Concerns in AI-Powered Surveillance:</strong>
<ul>
<li><strong>Prompt:</strong> Investigate the ethical considerations surrounding the use of artificial intelligence in surveillance systems. Examine how facial recognition and other AI technologies may impact individuals’ privacy and civil liberties. Discuss the balance between security concerns and the protection of individual rights. Explore cases where AI-powered surveillance has raised ethical concerns and consider regulatory approaches.</li>
<li><strong>Resource:</strong> <a href="https://stopspying.org/facial-recognition/">Surveillance Technology Oversight Project (STOP) - Facial Recognition</a></li>
</ul></li>
<li><strong>Explainability and Transparency in AI Models:</strong>
<ul>
<li><strong>Prompt:</strong> Explore the ethical implications of using complex machine learning models that lack transparency and explainability. Discuss the challenges associated with making AI systems understandable to non-experts, especially in critical domains such as healthcare and finance. Consider the trade-offs between model accuracy and interpretability and investigate approaches to ensure transparency in AI decision-making.</li>
<li><strong>Resource:</strong> <a href="https://christophm.github.io/interpretable-ml-book/">Interpretable Machine Learning: A Guide for Making Black Box Models Explainable</a></li>
</ul></li>
<li><strong>AI and Disinformation:</strong>
<ul>
<li><strong>Prompt:</strong> Investigate how artificial intelligence is used in the generation and dissemination of disinformation. Explore cases where AI technologies have been employed to create deepfakes or generate misleading content. Discuss the ethical concerns related to the potential misuse of AI in spreading misinformation and the challenges in developing countermeasures. Consider the role of AI practitioners in addressing this issue.</li>
<li><strong>Resource:</strong> <a href="https://www.weforum.org/reports/deepfakes-and-synthetic-media-mapping-the-landscape-and-understanding-the-risks">Deepfakes and Synthetic Media: Mapping the Landscape</a></li>
</ul></li>
</ol>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">Case Studies</h2>
<ol type="1">
<li><strong>Amazon’s Gender-Biased Recruitment Tool:</strong>
<ul>
<li><strong>Description:</strong> Amazon’s attempt to use machine learning for automated hiring was criticized for bias against female candidates.</li>
<li><strong>Resource:</strong> <a href="https://www.reuters.com/article/us-amazon-com-jobs-automation-insight-idUSKCN1MK08G">Amazon scraps secret AI recruiting tool that showed bias against women</a></li>
</ul></li>
<li><strong>ProPublica’s Analysis of COMPAS (Correctional Offender Management Profiling for Alternative Sanctions):</strong>
<ul>
<li><strong>Description:</strong> ProPublica’s investigation revealed racial bias in the COMPAS algorithm used in criminal sentencing, leading to unfair predictions.</li>
<li><strong>Resource:</strong> <a href="https://www.propublica.org/article/machine-bias-risk-assessments-in-criminal-sentencing">Machine Bias</a></li>
</ul></li>
<li><strong>Google Photos Mislabeling:</strong>
<ul>
<li><strong>Description:</strong> Google Photos’ image recognition system mislabeled photos of people, including categorizing individuals of certain ethnicities as animals.</li>
<li><strong>Resource:</strong> <a href="https://www.theverge.com/2015/7/1/8880363/google-apologizes-racially-insensitive-image-recognition">Google Photos, racial bias, and flawed machine learning</a></li>
</ul></li>
<li><strong>AI-Powered Facial Recognition and Surveillance:</strong>
<ul>
<li><strong>Description:</strong> The use of facial recognition technology in surveillance systems has raised concerns about privacy, civil liberties, and the potential for mass surveillance.</li>
<li><strong>Resource:</strong> <a href="https://arxiv.org/abs/1801.03842">Facial Recognition Technology: Current State of the Art and Ethical Considerations</a></li>
</ul></li>
<li><strong>Predictive Policing and Bias:</strong>
<ul>
<li><strong>Description:</strong> Predictive policing algorithms have been criticized for reinforcing biases and disproportionately targeting certain communities, raising concerns about fairness and discrimination.</li>
<li><strong>Resource:</strong> <a href="https://www.scientificamerican.com/article/the-perils-of-predictive-policing/">The Perils of Predictive Policing</a></li>
</ul></li>
<li><strong>Microsoft’s Tay Chatbot:</strong>
<ul>
<li><strong>Description:</strong> Microsoft’s AI-powered chatbot, Tay, was shut down after it started posting offensive and inappropriate content, highlighting the risks of unsupervised learning.</li>
<li><strong>Resource:</strong> <a href="https://www.bbc.com/news/technology-35902104">Microsoft’s AI chatbot Tay suspended after Internet ‘abuse’</a></li>
</ul></li>
<li><strong>Deepfake Technology for Misinformation:</strong>
<ul>
<li><strong>Description:</strong> The use of deepfake technology to create realistic but fake videos has raised concerns about the potential for spreading misinformation and manipulating public opinion.</li>
<li><strong>Resource:</strong> <a href="https://www.weforum.org/reports/deepfakes-and-synthetic-media-mapping-the-landscape-and-understanding-the-risks">Deepfakes and Synthetic Media: Mapping the Landscape</a></li>
</ul></li>
<li><strong>Automated Content Moderation on Social Media:</strong>
<ul>
<li><strong>Description:</strong> AI-powered content moderation systems on social media platforms have been criticized for both overcensorship and failure to prevent the spread of harmful content.</li>
<li><strong>Resource:</strong> <a href="https://www.theverge.com/2020/6/24/21302263/facebook-ai-content-moderation-mistakes-terrorism-extremist-content">The challenges of AI content moderation</a></li>
</ul></li>
<li><strong>Automated Grading Bias in Education:</strong>
<ul>
<li><strong>Description:</strong> Machine learning algorithms used for automated grading have been found to exhibit biases, potentially disadvantaging certain students.</li>
<li><strong>Resource:</strong> <a href="https://www.researchgate.net/publication/350328763_Automated_essay_grading_in_the_presence_of_biased_ratings">Automated essay grading in the presence of biased ratings</a></li>
</ul></li>
<li><strong>Autonomous Vehicles and Ethical Dilemmas:</strong>
<ul>
<li><strong>Description:</strong> The development of autonomous vehicles raises ethical dilemmas regarding decision-making in situations where harm is inevitable, leading to debates about prioritizing different stakeholders.</li>
<li><strong>Resource:</strong> <a href="https://www.nature.com/articles/s41586-018-0637-6">The Moral Machine Experiment</a></li>
</ul></li>
</ol>
</section>
<section id="approaches-to-ethical-machine-learning" class="level2">
<h2 class="anchored" data-anchor-id="approaches-to-ethical-machine-learning">Approaches to Ethical Machine Learning</h2>
<ol type="1">
<li><strong>Ethical AI Principles by Leading Organizations:</strong>
<ul>
<li><strong>Description:</strong> Many leading organizations have established ethical AI principles to guide the responsible development and deployment of artificial intelligence.</li>
<li><strong>Resource:</strong> <a href="https://futureoflife.org/ai-principles/">Principles of AI - Future of Life Institute</a></li>
</ul></li>
<li><strong>Explainable AI (XAI):</strong>
<ul>
<li><strong>Description:</strong> Developing machine learning models that are interpretable and provide explanations for their decisions, enhancing transparency and accountability.</li>
<li><strong>Resource:</strong> <a href="https://arxiv.org/abs/1901.04592">Interpretable Machine Learning: Overview, Challenges, and Opportunities</a></li>
</ul></li>
<li><strong>Fairness and Bias Mitigation Techniques:</strong>
<ul>
<li><strong>Description:</strong> Techniques to identify and mitigate biases in machine learning models to ensure fair outcomes across different demographic groups.</li>
<li><strong>Resource:</strong> <a href="https://aif360.mybluemix.net/">AI Fairness 360 - Toolkit for Fair and Explainable AI</a></li>
</ul></li>
<li><strong>AI Ethics Committees and Impact Assessments:</strong>
<ul>
<li><strong>Description:</strong> Establishment of AI ethics committees and the implementation of impact assessments to evaluate the ethical implications of AI projects before deployment.</li>
<li><strong>Resource:</strong> <a href="https://www.oecd.org/going-digital/ai/principles/">OECD AI Principles</a></li>
</ul></li>
<li><strong>Data Governance and Responsible Data Practices:</strong>
<ul>
<li><strong>Description:</strong> Implementing robust data governance frameworks and responsible data practices to ensure the ethical collection, storage, and usage of data in AI projects.</li>
<li><strong>Resource:</strong> <a href="https://www.datastewardshipwizard.org/dsw_blog/data-ethics-and-the-role-of-data-stewards/">Data Ethics and the Role of Data Stewards</a></li>
</ul></li>
<li><strong>AI for Social Good and Impact Assessment:</strong>
<ul>
<li><strong>Description:</strong> Encouraging the development and application of AI for social good, along with assessing the impact of AI technologies on society and the environment.</li>
<li><strong>Resource:</strong> <a href="https://www.microsoft.com/en-us/research/project/ai-for-social-good/">AI for Social Good: The Responsible AI Lifecycle</a></li>
</ul></li>
<li><strong>Responsible AI Certification and Standards:</strong>
<ul>
<li><strong>Description:</strong> Certification programs and standards that assess and verify the ethical and responsible practices of AI systems.</li>
<li><strong>Resource:</strong> <a href="https://standards.ieee.org/project/7003.html">IEEE P7003 - Standard for Algorithmic Bias Considerations</a></li>
</ul></li>
<li><strong>Public Awareness and Education Initiatives:</strong>
<ul>
<li><strong>Description:</strong> Public awareness campaigns and educational initiatives to inform the general public, policymakers, and developers about the ethical considerations of AI.</li>
<li><strong>Resource:</strong> <a href="https://www.weforum.org/whitepapers/ai-ethics-guidelines-for-policymakers/">AI Ethics Guidelines for Policymakers</a></li>
</ul></li>
<li><strong>AI Transparency and Open Source Practices:</strong>
<ul>
<li><strong>Description:</strong> Advocacy for transparency in AI development, including open-sourcing AI models and sharing code to facilitate scrutiny and collaboration.</li>
<li><strong>Resource:</strong> <a href="https://www.openai.com/charter/">OpenAI’s Charter</a></li>
</ul></li>
<li><strong>Collaborative and Multidisciplinary Approaches:</strong></li>
</ol>
<ul>
<li><strong>Description:</strong> Encouraging collaboration between AI researchers, ethicists, policymakers, and other stakeholders to address ethical challenges from diverse perspectives.</li>
<li><strong>Resource:</strong> <a href="https://www.partnershiponai.org/">Partnership on AI</a></li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div>CC BY-NC-SA 4.0</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>